#include <bits/stdc++.h>
using namespace std;

int main()
{
return 0;
}

// calculator with virtual machine v0.0
// I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CgplbnVtIFRva2VuVHlwZSB7CiAgICBUVF9OVU1CRVIsCiAgICBUVF9PUCwKICAgIFRUX0lERU5USUZJRVIsCiAgICBUVF9FUSwKICAgIFRUX0tFWVdPUkQsCiAgICBUVF9MUEFSRU4sCiAgICBUVF9SUEFSRU4sCiAgICBUVF9NQVhMSU1JVAp9OwoKc3RydWN0IFRva2VuIHsKICAgIFRva2VuVHlwZSB0eXBlOwogICAgc3RyaW5nIHZhbHVlOwpwdWJsaWM6CiAgICBUb2tlbihUb2tlblR5cGUgdHlwZSA9IFRUX01BWExJTUlULCBzdHJpbmcgdmFsdWUgPSAiIikgOiB0eXBlKHR5cGUpLCB2YWx1ZSh2YWx1ZSkge30KICAgIG9wZXJhdG9yIHN0cmluZygpIHsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICB9Cn07CgovLyBTb3VyY2UgLT4gVG9rZW4gc3RyZWFtCgpzdHJ1Y3QgTGV4ZXIgewpwcml2YXRlOgogICAgdmVjdG9yPFRva2VuPiB0b2tlbnM7CiAgICBtYXA8c3RyaW5nLCBUb2tlblR5cGU+IGtleXdvcmRzOwogICAgc3RyaW5nIHNvdXJjZTsKICAgIGNoYXIgY3VycmVudF9jaGFyOwogICAgaW50IHBvczsKICAgIHZvaWQgYWR2YW5jZSgpIHsKICAgICAgICBwb3MrKzsKICAgICAgICBpZiAocG9zID49IHNvdXJjZS5zaXplKCkpIGN1cnJlbnRfY2hhciA9IDA7CiAgICAgICAgZWxzZSBjdXJyZW50X2NoYXIgPSBzb3VyY2VbcG9zXTsKICAgIH0KICAgIFRva2VuIG1ha2VfZGlnaXQoKSB7CiAgICAgICAgc3RyaW5nIG51bTsKICAgICAgICB3aGlsZSAoaXNkaWdpdChjdXJyZW50X2NoYXIpKSB7CiAgICAgICAgICAgIG51bSArPSBjdXJyZW50X2NoYXI7CiAgICAgICAgICAgIGFkdmFuY2UoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFRva2VuKFRUX05VTUJFUiwgbnVtKTsKICAgIH0KICAgIFRva2VuIG1ha2VfaWRlbnRpZmllcigpIHsKICAgICAgICBzdHJpbmcgaWRlbnQ7CiAgICAgICAgd2hpbGUgKGlzYWxudW0oY3VycmVudF9jaGFyKSB8fCBjdXJyZW50X2NoYXIgPT0gJ18nKSB7CiAgICAgICAgICAgIGlkZW50ICs9IGN1cnJlbnRfY2hhcjsKICAgICAgICAgICAgYWR2YW5jZSgpOwogICAgICAgIH0KICAgICAgICBpZiAoa2V5d29yZHMuY291bnQoaWRlbnQpKSByZXR1cm4gVG9rZW4oa2V5d29yZHNbaWRlbnRdLCBpZGVudCk7CiAgICAgICAgcmV0dXJuIFRva2VuKFRUX0lERU5USUZJRVIsIGlkZW50KTsKICAgIH0KcHVibGljOgogICAgTGV4ZXIoc3RyaW5nIHNvdXJjZSkgOiBzb3VyY2Uoc291cmNlKSwgcG9zKC0xKSB7CiAgICAgICAgYWR2YW5jZSgpOwoKICAgICAgICBrZXl3b3Jkc1sidmFyIl0gPSBUVF9LRVlXT1JEOwogICAgfQogICAgdmVjdG9yPFRva2VuPiBtYWtlX3Rva2VucygpIHsKICAgICAgICB3aGlsZSAoY3VycmVudF9jaGFyKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50X2NoYXIgPT0gJysnKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaF9iYWNrKFRva2VuKFRUX09QLCAiKyIpKTsKICAgICAgICAgICAgICAgIGFkdmFuY2UoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X2NoYXIgPT0gJy0nKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaF9iYWNrKFRva2VuKFRUX09QLCAiLSIpKTsKICAgICAgICAgICAgICAgIGFkdmFuY2UoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X2NoYXIgPT0gJyonKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaF9iYWNrKFRva2VuKFRUX09QLCAiKiIpKTsKICAgICAgICAgICAgICAgIGFkdmFuY2UoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X2NoYXIgPT0gJy8nKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaF9iYWNrKFRva2VuKFRUX09QLCAiLyIpKTsKICAgICAgICAgICAgICAgIGFkdmFuY2UoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X2NoYXIgPT0gJyUnKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaF9iYWNrKFRva2VuKFRUX09QLCAiJSIpKTsKICAgICAgICAgICAgICAgIGFkdmFuY2UoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X2NoYXIgPT0gJygnKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaF9iYWNrKFRva2VuKFRUX0xQQVJFTiwgIigiKSk7CiAgICAgICAgICAgICAgICBhZHZhbmNlKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudF9jaGFyID09ICcpJykgewogICAgICAgICAgICAgICAgdG9rZW5zLnB1c2hfYmFjayhUb2tlbihUVF9SUEFSRU4sICIpIikpOwogICAgICAgICAgICAgICAgYWR2YW5jZSgpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRfY2hhciA9PSAnPScpIHsKICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoX2JhY2soVG9rZW4oVFRfRVEsICI9IikpOwogICAgICAgICAgICAgICAgYWR2YW5jZSgpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGlzZGlnaXQoY3VycmVudF9jaGFyKSkgewogICAgICAgICAgICAgICAgdG9rZW5zLnB1c2hfYmFjayhtYWtlX2RpZ2l0KCkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGlzYWxwaGEoY3VycmVudF9jaGFyKSB8fCBjdXJyZW50X2NoYXIgPT0gJ18nKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaF9iYWNrKG1ha2VfaWRlbnRpZmllcigpKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X2NoYXIgPT0gJyAnIHx8IGN1cnJlbnRfY2hhciA9PSAnCicgfHwgY3VycmVudF9jaGFyID09ICcJJykgYWR2YW5jZSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdG9rZW5zOwogICAgfQp9OwoKZW51bSBOb2RlVHlwZSB7CiAgICBOT0RFX1VOQVJZT1AsCiAgICBOT0RFX0JJTk9QLAogICAgTk9ERV9OVU1CRVIsCiAgICBOT0RFX1ZBUkRFQ0wsCiAgICBOT0RFX1ZBUkFTU0lHTiwKICAgIE5PREVfVkFSUkVBRAp9OwoKc3RydWN0IEJhc2VOb2RlIHsKcHVibGljOgogICAgdmlydHVhbCB+QmFzZU5vZGUoKSB7fQogICAgdmlydHVhbCBOb2RlVHlwZSBnZXRUeXBlKCkgPSAwOwogICAgdmlydHVhbCBzdHJpbmcgdG9zdHJpbmcoKSA9IDA7Cn07CgpzdHJ1Y3QgQmluT3BOb2RlIDogcHVibGljIEJhc2VOb2RlIHsKICAgIEJhc2VOb2RlICpsaHMsICpyaHM7CiAgICBUb2tlbiBvcDsKcHVibGljOgogICAgQmluT3BOb2RlKEJhc2VOb2RlICpsaHMsIFRva2VuIG9wLCBCYXNlTm9kZSAqcmhzKSA6IGxocyhsaHMpLCBvcChvcCksIHJocyhyaHMpIHt9CiAgICB2aXJ0dWFsIH5CaW5PcE5vZGUoKSB7CiAgICAgICAgZGVsZXRlIGxoczsKICAgICAgICBkZWxldGUgcmhzOwogICAgfQogICAgdmlydHVhbCBOb2RlVHlwZSBnZXRUeXBlKCkgewogICAgICAgIHJldHVybiBOT0RFX0JJTk9QOwogICAgfQogICAgdmlydHVhbCBzdHJpbmcgdG9zdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICJCaW5PcE5vZGUoIiArIGxocy0+dG9zdHJpbmcoKSArICIsICIgKyBzdHJpbmcob3ApICsgIiwgIiArIHJocy0+dG9zdHJpbmcoKSArICIpIjsKICAgIH0KfTsKCnN0cnVjdCBVbmFyeU9wTm9kZSA6IHB1YmxpYyBCYXNlTm9kZSB7CiAgICBCYXNlTm9kZSAqbm9kZTsKICAgIFRva2VuIG9wOwpwdWJsaWM6CiAgICBVbmFyeU9wTm9kZShUb2tlbiBvcCwgQmFzZU5vZGUgKm5vZGUpIDogbm9kZShub2RlKSwgb3Aob3ApIHt9CiAgICB2aXJ0dWFsIH5VbmFyeU9wTm9kZSgpIHsKICAgICAgICBkZWxldGUgbm9kZTsKICAgIH0KICAgIHZpcnR1YWwgTm9kZVR5cGUgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gTk9ERV9VTkFSWU9QOwogICAgfQogICAgdmlydHVhbCBzdHJpbmcgdG9zdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICJVbmFyeU9wTm9kZSgiICsgbm9kZS0+dG9zdHJpbmcoKSArICIsICIgKyBzdHJpbmcob3ApICsgIikiOwogICAgfQp9OwoKc3RydWN0IE51bWJlck5vZGUgOiBwdWJsaWMgQmFzZU5vZGUgewogICAgVG9rZW4gbnVtOwpwdWJsaWM6CiAgICBOdW1iZXJOb2RlKFRva2VuIG51bSkgOiBudW0obnVtKSB7fQogICAgdmlydHVhbCBOb2RlVHlwZSBnZXRUeXBlKCkgewogICAgICAgIHJldHVybiBOT0RFX05VTUJFUjsKICAgIH0KICAgIHZpcnR1YWwgc3RyaW5nIHRvc3RyaW5nKCkgewogICAgICAgIHJldHVybiAiTnVtYmVyTm9kZSgiICsgc3RyaW5nKG51bSkgKyAiKSI7CiAgICB9Cn07CgpzdHJ1Y3QgVmFyRGVjbE5vZGUgOiBwdWJsaWMgQmFzZU5vZGUgewogICAgVG9rZW4gbmFtZTsKICAgIEJhc2VOb2RlICp2YWx1ZTsKcHVibGljOgogICAgVmFyRGVjbE5vZGUoVG9rZW4gbmFtZSwgQmFzZU5vZGUgKnZhbHVlKSA6IG5hbWUobmFtZSksIHZhbHVlKHZhbHVlKSB7fQogICAgflZhckRlY2xOb2RlKCkgewogICAgICAgIGRlbGV0ZSB2YWx1ZTsKICAgIH0KICAgIHZpcnR1YWwgTm9kZVR5cGUgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gTk9ERV9WQVJERUNMOwogICAgfQogICAgdmlydHVhbCBzdHJpbmcgdG9zdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICJWYXJEZWNsTm9kZSgiICsgc3RyaW5nKG5hbWUpICsgIiA9ICIgKyB2YWx1ZS0+dG9zdHJpbmcoKSArICIpIjsKICAgIH0KfTsKCnN0cnVjdCBWYXJBc3NpZ25Ob2RlIDogcHVibGljIEJhc2VOb2RlIHsKICAgIFRva2VuIG5hbWU7CiAgICBCYXNlTm9kZSAqdmFsdWU7CnB1YmxpYzoKICAgIFZhckFzc2lnbk5vZGUoVG9rZW4gbmFtZSwgQmFzZU5vZGUgKnZhbHVlKSA6IG5hbWUobmFtZSksIHZhbHVlKHZhbHVlKSB7fQogICAgflZhckFzc2lnbk5vZGUoKSB7CiAgICAgICAgZGVsZXRlIHZhbHVlOwogICAgfQogICAgdmlydHVhbCBOb2RlVHlwZSBnZXRUeXBlKCkgewogICAgICAgIHJldHVybiBOT0RFX1ZBUkFTU0lHTjsKICAgIH0KICAgIHZpcnR1YWwgc3RyaW5nIHRvc3RyaW5nKCkgewogICAgICAgIHJldHVybiAiVmFyQXNzaWduTm9kZSgiICsgc3RyaW5nKG5hbWUpICsgIiA9ICIgKyB2YWx1ZS0+dG9zdHJpbmcoKSArICIpIjsKICAgIH0KfTsKCnN0cnVjdCBWYXJSZWFkTm9kZSA6IHB1YmxpYyBCYXNlTm9kZSB7CiAgICBUb2tlbiBuYW1lOwpwdWJsaWM6CiAgICBWYXJSZWFkTm9kZShUb2tlbiBuYW1lKSA6IG5hbWUobmFtZSkge30KICAgIHZpcnR1YWwgTm9kZVR5cGUgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gTk9ERV9WQVJSRUFEOwogICAgfQogICAgdmlydHVhbCBzdHJpbmcgdG9zdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICJWYXJSZWFkTm9kZSgiICsgc3RyaW5nKG5hbWUpICsgIikiOwogICAgfQp9OwoKLy8gVG9rZW4gc3RyZWFtIC0+IEFTVAoKc3RydWN0IFBhcnNlciB7CnByaXZhdGU6CiAgICB2ZWN0b3I8VG9rZW4+IHNvdXJjZTsKICAgIFRva2VuIGN1cnJlbnRfdG9rOwogICAgaW50IHBvczsKICAgIHZvaWQgYWR2YW5jZSgpIHsKICAgICAgICBwb3MrKzsKICAgICAgICBpZiAocG9zID49IHNvdXJjZS5zaXplKCkpIGN1cnJlbnRfdG9rID0gVG9rZW4oVFRfTUFYTElNSVQsICIobnVsbCkiKTsKICAgICAgICBlbHNlIGN1cnJlbnRfdG9rID0gc291cmNlW3Bvc107CiAgICB9CiAgICBUb2tlbiBuZXh0VG9rZW4oKSB7CiAgICAgICAgaWYgKHBvcyArIDEgPj0gc291cmNlLnNpemUoKSkgcmV0dXJuIFRva2VuKFRUX01BWExJTUlULCAiKG51bGwpIik7CiAgICAgICAgcmV0dXJuIHNvdXJjZVtwb3MgKyAxXTsKICAgIH0KICAgIEJhc2VOb2RlICpwYXJzZV9wcm9ncmFtKCkgewogICAgICAgIGlmIChjdXJyZW50X3Rvay50eXBlID09IFRUX0tFWVdPUkQgJiYgY3VycmVudF90b2sudmFsdWUgPT0gInZhciIpIHsKICAgICAgICAgICAgcmV0dXJuIHBhcnNlX3Zhcl9kZWNsX2V4cHIoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHBhcnNlX2V4cHIoKTsKICAgIH0KICAgIEJhc2VOb2RlICpwYXJzZV92YXJfZGVjbF9leHByKCkgewogICAgICAgIGFkdmFuY2UoKTsKICAgICAgICBUb2tlbiBuYW1lID0gY3VycmVudF90b2s7CiAgICAgICAgYWR2YW5jZSgpOwogICAgICAgIGFkdmFuY2UoKTsKICAgICAgICBCYXNlTm9kZSAqdmFsdWUgPSBwYXJzZV9leHByKCk7CiAgICAgICAgcmV0dXJuIG5ldyBWYXJEZWNsTm9kZShuYW1lLCB2YWx1ZSk7CiAgICB9CiAgICBCYXNlTm9kZSAqcGFyc2VfdmFyX2Fzc2lnbl9leHByKCkgewogICAgICAgIFRva2VuIG5hbWUgPSBjdXJyZW50X3RvazsKICAgICAgICBhZHZhbmNlKCk7CiAgICAgICAgYWR2YW5jZSgpOwogICAgICAgIEJhc2VOb2RlICp2YWx1ZSA9IHBhcnNlX2V4cHIoKTsKICAgICAgICByZXR1cm4gbmV3IFZhckFzc2lnbk5vZGUobmFtZSwgdmFsdWUpOwogICAgfQogICAgQmFzZU5vZGUgKnBhcnNlX2V4cHIoKSB7CiAgICAgICAgaWYgKGN1cnJlbnRfdG9rLnR5cGUgPT0gVFRfSURFTlRJRklFUiAmJiBuZXh0VG9rZW4oKS50eXBlID09IFRUX0VRKSB7CiAgICAgICAgICAgIHJldHVybiBwYXJzZV92YXJfYXNzaWduX2V4cHIoKTsKICAgICAgICB9CiAgICAgICAgQmFzZU5vZGUgKmxlZnQgPSBwYXJzZV90ZXJtKCk7CiAgICAgICAgd2hpbGUgKGN1cnJlbnRfdG9rLnZhbHVlID09ICIrIiB8fCBjdXJyZW50X3Rvay52YWx1ZSA9PSAiLSIpIHsKICAgICAgICAgICAgVG9rZW4gb3AgPSBjdXJyZW50X3RvazsKICAgICAgICAgICAgYWR2YW5jZSgpOwogICAgICAgICAgICBCYXNlTm9kZSAqcmlnaHQgPSBwYXJzZV90ZXJtKCk7CiAgICAgICAgICAgIGxlZnQgPSBuZXcgQmluT3BOb2RlKGxlZnQsIG9wLCByaWdodCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBsZWZ0OwogICAgfQogICAgQmFzZU5vZGUgKnBhcnNlX3Rlcm0oKSB7CiAgICAgICAgQmFzZU5vZGUgKmxlZnQgPSBwYXJzZV9mYWN0b3IoKTsKICAgICAgICB3aGlsZSAoY3VycmVudF90b2sudmFsdWUgPT0gIioiIHx8IGN1cnJlbnRfdG9rLnZhbHVlID09ICIvIiB8fCBjdXJyZW50X3Rvay52YWx1ZSA9PSAiJSIpIHsKICAgICAgICAgICAgVG9rZW4gb3AgPSBjdXJyZW50X3RvazsKICAgICAgICAgICAgYWR2YW5jZSgpOwogICAgICAgICAgICBCYXNlTm9kZSAqcmlnaHQgPSBwYXJzZV9mYWN0b3IoKTsKICAgICAgICAgICAgbGVmdCA9IG5ldyBCaW5PcE5vZGUobGVmdCwgb3AsIHJpZ2h0KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGxlZnQ7CiAgICB9CiAgICBCYXNlTm9kZSAqcGFyc2VfZmFjdG9yKCkgewogICAgICAgIGlmIChjdXJyZW50X3Rvay50eXBlID09IFRUX05VTUJFUikgewogICAgICAgICAgICBUb2tlbiBudW0gPSBjdXJyZW50X3RvazsKICAgICAgICAgICAgYWR2YW5jZSgpOwogICAgICAgICAgICByZXR1cm4gbmV3IE51bWJlck5vZGUobnVtKTsKICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRfdG9rLnR5cGUgPT0gVFRfSURFTlRJRklFUikgewogICAgICAgICAgICBUb2tlbiBuYW1lID0gY3VycmVudF90b2s7CiAgICAgICAgICAgIGFkdmFuY2UoKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBWYXJSZWFkTm9kZShuYW1lKTsKICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRfdG9rLnZhbHVlID09ICItIikgewogICAgICAgICAgICBUb2tlbiBvcCA9IGN1cnJlbnRfdG9rOwogICAgICAgICAgICBhZHZhbmNlKCk7CiAgICAgICAgICAgIEJhc2VOb2RlICpyaWdodCA9IHBhcnNlX2ZhY3RvcigpOwogICAgICAgICAgICByZXR1cm4gbmV3IFVuYXJ5T3BOb2RlKG9wLCByaWdodCk7CiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X3Rvay50eXBlID09IFRUX0xQQVJFTikgewogICAgICAgICAgICBhZHZhbmNlKCk7CiAgICAgICAgICAgIEJhc2VOb2RlICpleHByID0gcGFyc2VfZXhwcigpOwogICAgICAgICAgICBhZHZhbmNlKCk7CiAgICAgICAgICAgIHJldHVybiBleHByOwogICAgICAgIH0KICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KcHVibGljOgogICAgUGFyc2VyKHZlY3RvcjxUb2tlbj4gdG9rZW5zKSA6IHNvdXJjZSh0b2tlbnMpLCBwb3MoLTEpIHsKICAgICAgICBhZHZhbmNlKCk7CiAgICB9CiAgICBCYXNlTm9kZSAqcGFyc2UoKSB7CiAgICAgICAgcmV0dXJuIHBhcnNlX3Byb2dyYW0oKTsKICAgIH0KfTsKCi8vIEFTVCAtPiBPcGNvZGUKCnN0cnVjdCBWaXNpdG9yIHsKcHJpdmF0ZToKICAgIHZpcnR1YWwgaW50IHZpc2l0X0Jpbk9wTm9kZShCaW5PcE5vZGUgKm5vZGUpID0gMDsKICAgIHZpcnR1YWwgaW50IHZpc2l0X051bWJlck5vZGUoTnVtYmVyTm9kZSAqbm9kZSkgPSAwOwogICAgdmlydHVhbCBpbnQgdmlzaXRfVW5hcnlPcE5vZGUoVW5hcnlPcE5vZGUgKm5vZGUpID0gMDsKICAgIHZpcnR1YWwgaW50IHZpc2l0X1ZhckRlY2xOb2RlKFZhckRlY2xOb2RlICpub2RlKSA9IDA7CiAgICB2aXJ0dWFsIGludCB2aXNpdF9WYXJBc3NpZ25Ob2RlKFZhckFzc2lnbk5vZGUgKm5vZGUpID0gMDsKICAgIHZpcnR1YWwgaW50IHZpc2l0X1ZhclJlYWROb2RlKFZhclJlYWROb2RlICpub2RlKSA9IDA7CnB1YmxpYzoKICAgIHZpcnR1YWwgaW50IHZpc2l0KEJhc2VOb2RlICpub2RlKSB7CiAgICAgICAgc3dpdGNoIChub2RlLT5nZXRUeXBlKCkpIHsKICAgICAgICAgICAgY2FzZSBOT0RFX0JJTk9QOgogICAgICAgICAgICAgICAgcmV0dXJuIHZpc2l0X0Jpbk9wTm9kZSgoQmluT3BOb2RlICopIG5vZGUpOwogICAgICAgICAgICBjYXNlIE5PREVfVU5BUllPUDoKICAgICAgICAgICAgICAgIHJldHVybiB2aXNpdF9VbmFyeU9wTm9kZSgoVW5hcnlPcE5vZGUgKikgbm9kZSk7CiAgICAgICAgICAgIGNhc2UgTk9ERV9OVU1CRVI6CiAgICAgICAgICAgICAgICByZXR1cm4gdmlzaXRfTnVtYmVyTm9kZSgoTnVtYmVyTm9kZSAqKSBub2RlKTsKICAgICAgICAgICAgY2FzZSBOT0RFX1ZBUkRFQ0w6CiAgICAgICAgICAgICAgICByZXR1cm4gdmlzaXRfVmFyRGVjbE5vZGUoKFZhckRlY2xOb2RlICopIG5vZGUpOwogICAgICAgICAgICBjYXNlIE5PREVfVkFSQVNTSUdOOgogICAgICAgICAgICAgICAgcmV0dXJuIHZpc2l0X1ZhckFzc2lnbk5vZGUoKFZhckFzc2lnbk5vZGUgKikgbm9kZSk7CiAgICAgICAgICAgIGNhc2UgTk9ERV9WQVJSRUFEOgogICAgICAgICAgICAgICAgcmV0dXJuIHZpc2l0X1ZhclJlYWROb2RlKChWYXJSZWFkTm9kZSAqKSBub2RlKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KfTsKCmVudW0gQnl0ZUNvZGUgewogICAgT1BfUFVTSCwKICAgIE9QX0FERCwKICAgIE9QX1NVQiwKICAgIE9QX01VTCwKICAgIE9QX0RJViwKICAgIE9QX01PRCwKICAgIE9QX05FRywKICAgIE9QX0RFQ0xWQVIsCiAgICBPUF9TRVRWQVIsCiAgICBPUF9HRVRWQVIsCn07Cgp2ZWN0b3I8aW50PiBiYzsKbWFwPGludCwgaW50PiBzeW1ib2xfdGFibGU7CgppbnQgaGFzaGVyKHN0cmluZyBzdHIpCnsKICAgIGludCByZXMgPSAwOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdHIuc2l6ZSgpOyBpKyspIHsKICAgICAgICBpbnQgY2ggPSBzdHJbaV07CiAgICAgICAgY2ggLT0gJzAnOwogICAgICAgIGNoIF49IGNoIDw8IDY7CiAgICAgICAgY2ggXj0gY2ggPj4gODsKICAgICAgICBjaCB8PSBjaCAmIDE0OwogICAgICAgIGNoIF49IGNoID4+IDE7CiAgICAgICAgY2ggKz0gJzAnOwogICAgICAgIHJlcyArPSBjaCAqICgxIDw8IChpICUgMzIpKTsKICAgIH0KICAgIHJldHVybiByZXM7Cn0KCnN0cnVjdCBUcmFuc2xhdG9yIDogcHVibGljIFZpc2l0b3Igewpwcml2YXRlOgogICAgdmlydHVhbCBpbnQgdmlzaXRfQmluT3BOb2RlKEJpbk9wTm9kZSAqbm9kZSkgewogICAgICAgIHZpc2l0KG5vZGUtPmxocyk7CiAgICAgICAgdmlzaXQobm9kZS0+cmhzKTsKICAgICAgICBzd2l0Y2ggKG5vZGUtPm9wLnZhbHVlWzBdKSB7CiAgICAgICAgICAgIGNhc2UgJysnOiBiYy5wdXNoX2JhY2soT1BfQUREKTsgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJy0nOiBiYy5wdXNoX2JhY2soT1BfU1VCKTsgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJyonOiBiYy5wdXNoX2JhY2soT1BfTVVMKTsgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJy8nOiBiYy5wdXNoX2JhY2soT1BfRElWKTsgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJyUnOiBiYy5wdXNoX2JhY2soT1BfTU9EKTsgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQogICAgdmlydHVhbCBpbnQgdmlzaXRfTnVtYmVyTm9kZShOdW1iZXJOb2RlICpub2RlKSB7CiAgICAgICAgYmMucHVzaF9iYWNrKE9QX1BVU0gpOwogICAgICAgIGludCBuID0gMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG5vZGUtPm51bS52YWx1ZS5zaXplKCk7IGkrKykgbiA9IG4gKiAxMCArIG5vZGUtPm51bS52YWx1ZVtpXSAtICcwJzsKICAgICAgICBiYy5wdXNoX2JhY2sobik7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB2aXJ0dWFsIGludCB2aXNpdF9VbmFyeU9wTm9kZShVbmFyeU9wTm9kZSAqbm9kZSkgewogICAgICAgIHZpc2l0KG5vZGUtPm5vZGUpOwogICAgICAgIGJjLnB1c2hfYmFjayhPUF9ORUcpOwogICAgICAgIHJldHVybiAwOwogICAgfQogICAgdmlydHVhbCBpbnQgdmlzaXRfVmFyUmVhZE5vZGUoVmFyUmVhZE5vZGUgKm5vZGUpIHsKICAgICAgICBiYy5wdXNoX2JhY2soT1BfR0VUVkFSKTsKICAgICAgICBiYy5wdXNoX2JhY2soaGFzaGVyKG5vZGUtPm5hbWUpKTsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIHZpcnR1YWwgaW50IHZpc2l0X1ZhckFzc2lnbk5vZGUoVmFyQXNzaWduTm9kZSAqbm9kZSkgewogICAgICAgIHZpc2l0KG5vZGUtPnZhbHVlKTsKICAgICAgICBiYy5wdXNoX2JhY2soT1BfU0VUVkFSKTsKICAgICAgICBiYy5wdXNoX2JhY2soaGFzaGVyKG5vZGUtPm5hbWUpKTsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIHZpcnR1YWwgaW50IHZpc2l0X1ZhckRlY2xOb2RlKFZhckRlY2xOb2RlICpub2RlKSB7CiAgICAgICAgdmlzaXQobm9kZS0+dmFsdWUpOwogICAgICAgIGJjLnB1c2hfYmFjayhPUF9ERUNMVkFSKTsKICAgICAgICBiYy5wdXNoX2JhY2soaGFzaGVyKG5vZGUtPm5hbWUpKTsKICAgICAgICByZXR1cm4gMDsKICAgIH0KfTsKCnN0YWNrPGludD4gc3RrOwoKaW50IHZtZXhlYygpCnsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYmMuc2l6ZSgpOyBpKyspIHsKICAgICAgICBzd2l0Y2ggKGJjW2ldKSB7CiAgICAgICAgICAgIGNhc2UgT1BfUFVTSDogewogICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgc3RrLnB1c2goYmNbaV0pOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSBPUF9BREQ6IHsKICAgICAgICAgICAgICAgIGludCBiID0gc3RrLnRvcCgpOyBzdGsucG9wKCk7CiAgICAgICAgICAgICAgICBpbnQgYSA9IHN0ay50b3AoKTsgc3RrLnBvcCgpOwogICAgICAgICAgICAgICAgc3RrLnB1c2goYSArIGIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSBPUF9TVUI6IHsKICAgICAgICAgICAgICAgIGludCBiID0gc3RrLnRvcCgpOyBzdGsucG9wKCk7CiAgICAgICAgICAgICAgICBpbnQgYSA9IHN0ay50b3AoKTsgc3RrLnBvcCgpOwogICAgICAgICAgICAgICAgc3RrLnB1c2goYSAtIGIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSBPUF9NVUw6IHsKICAgICAgICAgICAgICAgIGludCBiID0gc3RrLnRvcCgpOyBzdGsucG9wKCk7CiAgICAgICAgICAgICAgICBpbnQgYSA9IHN0ay50b3AoKTsgc3RrLnBvcCgpOwogICAgICAgICAgICAgICAgc3RrLnB1c2goYSAqIGIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSBPUF9ESVY6IHsKICAgICAgICAgICAgICAgIGludCBiID0gc3RrLnRvcCgpOyBzdGsucG9wKCk7CiAgICAgICAgICAgICAgICBpbnQgYSA9IHN0ay50b3AoKTsgc3RrLnBvcCgpOwogICAgICAgICAgICAgICAgc3RrLnB1c2goYSAvIGIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSBPUF9NT0Q6IHsKICAgICAgICAgICAgICAgIGludCBiID0gc3RrLnRvcCgpOyBzdGsucG9wKCk7CiAgICAgICAgICAgICAgICBpbnQgYSA9IHN0ay50b3AoKTsgc3RrLnBvcCgpOwogICAgICAgICAgICAgICAgc3RrLnB1c2goYSAlIGIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSBPUF9ERUNMVkFSOiB7CiAgICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgICAgICBpbnQgdmFsdWUgPSBzdGsudG9wKCk7IHN0ay5wb3AoKTsKICAgICAgICAgICAgICAgIGludCBuYW1lID0gYmNbaV07CiAgICAgICAgICAgICAgICBpZiAoc3ltYm9sX3RhYmxlLmNvdW50KG5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgY291dCA8PCAiRXJyb3Igd2hpbGUgZXhlY3V0aW5nOiB2YXJpYWJsZSBhbHJlYWR5IGV4aXN0CiI7CiAgICAgICAgICAgICAgICAgICAgY291dCA8PCAiRG9uJ3QgdGVsbCBtZSB3aHkgbm90IHByaW50IHRoZSB2YXJpYWJsZSBuYW1lLCBJIGxpdGVyYWxseSBkb24ndCBrbm93CiI7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc3ltYm9sX3RhYmxlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgICAgICBzdGsucHVzaCh2YWx1ZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlIE9QX1NFVFZBUjogewogICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgaW50IHZhbHVlID0gc3RrLnRvcCgpOyBzdGsucG9wKCk7CiAgICAgICAgICAgICAgICBpbnQgbmFtZSA9IGJjW2ldOwogICAgICAgICAgICAgICAgaWYgKCFzeW1ib2xfdGFibGUuY291bnQobmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICBjb3V0IDw8ICJFcnJvciB3aGlsZSBleGVjdXRpbmc6IHZhcmlhYmxlIGRvZXMgbm90IGV4aXN0CiI7CiAgICAgICAgICAgICAgICAgICAgY291dCA8PCAiRG9uJ3QgdGVsbCBtZSB3aHkgbm90IHByaW50IHRoZSB2YXJpYWJsZSBuYW1lLCBJIGxpdGVyYWxseSBkb24ndCBrbm93CiI7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc3ltYm9sX3RhYmxlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICAgICAgICBzdGsucHVzaCh2YWx1ZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlIE9QX0dFVFZBUjogewogICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgaW50IG5hbWUgPSBiY1tpXTsKICAgICAgICAgICAgICAgIGlmICghc3ltYm9sX3RhYmxlLmNvdW50KG5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgY291dCA8PCAiRXJyb3Igd2hpbGUgZXhlY3V0aW5nOiB2YXJpYWJsZSBkb2VzIG5vdCBleGlzdAoiOwogICAgICAgICAgICAgICAgICAgIGNvdXQgPDwgIkRvbid0IHRlbGwgbWUgd2h5IG5vdCBwcmludCB0aGUgdmFyaWFibGUgbmFtZSwgSSBsaXRlcmFsbHkgZG9uJ3Qga25vdwoiOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHN0ay5wdXNoKHN5bWJvbF90YWJsZVtuYW1lXSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGlmICghc3RrLmVtcHR5KCkpIHsKICAgICAgICBpbnQgcmVzID0gc3RrLnRvcCgpOyBzdGsucG9wKCk7CiAgICAgICAgcmV0dXJuIHJlczsKICAgIH0KICAgIHJldHVybiAwOwp9Cgp2b2lkIHJ1bihzdHJpbmcgaW5wdXQpCnsKICAgIExleGVyIGwgPSBMZXhlcihpbnB1dCk7CiAgICB2ZWN0b3I8VG9rZW4+IHQgPSBsLm1ha2VfdG9rZW5zKCk7CiAgICBQYXJzZXIgcCA9IFBhcnNlcih0KTsKICAgIEJhc2VOb2RlICpyb290ID0gcC5wYXJzZSgpOwogICAgVHJhbnNsYXRvciB0cmFuczsKICAgIHRyYW5zLnZpc2l0KHJvb3QpOwogICAgZGVsZXRlIHJvb3Q7CiAgICBpbnQgcmVzdWx0ID0gdm1leGVjKCk7CiAgICBjb3V0IDw8IHJlc3VsdCA8PCBlbmRsOwogICAgYmMuY2xlYXIoKTsKfQoKaW50IG1haW4oKQp7CiAgICBzdHJpbmcgcHJvbXB0ID0gImNhbGM+ICI7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIGNvdXQgPDwgcHJvbXB0OwogICAgICAgIHN0cmluZyBpbnB1dDsKICAgICAgICBnZXRsaW5lKGNpbiwgaW5wdXQpOwogICAgICAgIHJ1bihpbnB1dCk7CiAgICB9CiAgICByZXR1cm4gMDsKfQ==
// grammar:
// cHJvZ3JhbSA6Oj0gdmFyX2RlY2xfZXhwciB8IGZ1bmNfZXhwciB8IGV4cHIKdmFyX2V4cHIgOjo9IDxWQVI+IDxJREVOVElGSUVSPiA8RVE+IGV4cHIKZnVuY19leHByIDo6PSA8RlVOQz4gPElERU5USUZJRVI+IDxMUEFSRU4+IGFyZ19saXN0PyA8UlBBUkVOPiA8QVJST1c+IGV4cHIKYXJnX2xpc3QgOjo9IDxJREVOVElGSUVSPiAoPENPTU1BPiA8SURFTlRJRklFUj4pKgpwYXJhbV9saXN0IDo6PSBleHByICg8Q09NTUE+IGV4cHIpKgphc3NpZ25fZXhwciA6Oj0gPElERU5USUZJRVI+IDxFUT4gZXhwcgpleHByIDo6PSB0ZXJtICg8UExVU3xNSU5VUz4gdGVybSkqCiAgICAgICB8IGFzc2lnbl9leHByCnRlcm0gOjo9IGZhY3RvciAoPE1VTHxESVY+IGZhY3RvcikqCmZhY3RvciA6Oj0gPE5VTUJFUj4KICAgICAgIHwgPElERU5USUZJRVI+ICg8TFBBUkVOPiBwYXJhbV9saXN0PyA8UlBBUkVOPik/CiAgICAgICB8IDxMUEFSRU4+IGV4cHIgPFJQQVJFTj4KICAgICAgIHwgPE1JTlVTPiBmYWN0b3I=

// this is definitely not cheating cuz it's literally not related with CSP-S
